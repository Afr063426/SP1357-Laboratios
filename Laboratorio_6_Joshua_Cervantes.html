<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joshua Isaac Cervantes Artavia">
<meta name="dcterms.date" content="2023-10-14">

<title>Laboratorio 6, Tópicos en análisis datos 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Laboratorio_6_Joshua_Cervantes_files/libs/clipboard/clipboard.min.js"></script>
<script src="Laboratorio_6_Joshua_Cervantes_files/libs/quarto-html/quarto.js"></script>
<script src="Laboratorio_6_Joshua_Cervantes_files/libs/quarto-html/popper.min.js"></script>
<script src="Laboratorio_6_Joshua_Cervantes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Laboratorio_6_Joshua_Cervantes_files/libs/quarto-html/anchor.min.js"></script>
<link href="Laboratorio_6_Joshua_Cervantes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Laboratorio_6_Joshua_Cervantes_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Laboratorio_6_Joshua_Cervantes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Laboratorio_6_Joshua_Cervantes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Laboratorio_6_Joshua_Cervantes_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Laboratorio_6_Joshua_Cervantes.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Laboratorio 6, Tópicos en análisis datos 1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Joshua Isaac Cervantes Artavia </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 14, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># To manipulate data, and other things</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce) <span class="co"># To use ggcircle</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx) <span class="co"># To manipulate Excel</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># To make beatiful tables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'

The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ade4)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Directorio donde se ubica el qmd</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        directory <span class="ot">&lt;-</span> <span class="fu">dirname</span>(rstudioapi<span class="sc">::</span><span class="fu">getSourceEditorContext</span>()<span class="sc">$</span>path)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">setwd</span>(directory) <span class="co"># Establecer el directorio del archivo como la raiz</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">message</span>(<span class="st">""</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="st">""</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] ""</code></pre>
</div>
</div>
<section id="análisis-de-componentes-principales" class="level1">
<h1>Análisis de componentes principales</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(USArrests)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We make the pca</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>acp_res <span class="ot">&lt;-</span> <span class="fu">dudi.pca</span>(USArrests, <span class="at">scannf =</span> <span class="cn">FALSE</span>, <span class="at">nf =</span> <span class="dv">3</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We check that type of the object acp_res</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">is.dudi</span>(acp_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We check the rank of the matrix</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>acp_res<span class="sc">$</span>rank</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We check the number of factors</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>acp_res<span class="sc">$</span>nf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We check the eigen values</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>acp_res<span class="sc">$</span>eig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.4802416 0.9897652 0.3565632 0.1734301</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We do a bar plot</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(acp_res<span class="sc">$</span>eig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/acp_arrests-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We check the table centered, and also standarized</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>acp_res<span class="sc">$</span>tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Murder     Assault    UrbanPop         Rape
Alabama         1.25517927  0.79078716 -0.52619514 -0.003451159
Alaska          0.51301858  1.11805959 -1.22406668  2.509423922
Arizona         0.07236067  1.49381682  1.00912225  1.053466257
Arkansas        0.23470832  0.23321191 -1.08449238 -0.186793976
California      0.28109336  1.27563520  1.77678094  2.088813930
Colorado        0.02597562  0.40290872  0.86954794  1.883901370
Connecticut    -1.04088037 -0.73648418  0.79976079 -1.092723190
Delaware       -0.43787481  0.81502956  0.45082502 -0.585834225
Florida         1.76541475  1.99078607  1.00912225  1.150530102
Georgia         2.22926518  0.48775713 -0.38662083  0.492652934
Hawaii         -0.57702994 -1.51224105  1.21848371 -0.111299875
Idaho          -1.20322802 -0.61527217 -0.80534376 -0.758392170
Illinois        0.60578867  0.94836277  1.21848371  0.298525246
Indiana        -0.13637203 -0.70012057 -0.03768506 -0.025020902
Iowa           -1.29599811 -1.39102904 -0.59598230 -1.071153447
Kansas         -0.41468229 -0.67587817  0.03210209 -0.348567050
Kentucky        0.44344101 -0.74860538 -0.94491807 -0.531909867
Louisiana       1.76541475  0.94836277  0.03210209  0.104397557
Maine          -1.31919063 -1.06375661 -1.01470522 -1.448623952
Maryland        0.81452136  1.56654403  0.10188925  0.708350366
Massachusetts  -0.78576263 -0.26375734  1.35805802 -0.531909867
Michigan        1.00006153  1.02108998  0.59039932  1.495645992
Minnesota      -1.18003550 -1.19708982  0.03210209 -0.682898069
Mississippi     1.92776240  1.06957478 -1.50321530 -0.445630894
Missouri        0.28109336  0.08775750  0.31125071  0.751489853
Montana        -0.41468229 -0.74860538 -0.87513091 -0.521124995
Nebraska       -0.80895515 -0.83345379 -0.24704653 -0.510340124
Nevada          1.02325405  0.98472638  1.07890940  2.671196996
New Hampshire  -1.31919063 -1.37890783 -0.66576945 -1.265281135
New Jersey     -0.08998698 -0.14254532  1.63720664 -0.262288077
New Mexico      0.83771388  1.38472601  0.31125071  1.172099845
New York        0.76813632  1.00896878  1.42784517  0.525007549
North Carolina  1.20879423  2.01502847 -1.43342815 -0.553479610
North Dakota   -1.62069341 -1.52436225 -1.50321530 -1.502548310
Ohio           -0.11317951 -0.61527217  0.66018648  0.018118584
Oklahoma       -0.27552716 -0.23951493  0.17167640 -0.132869618
Oregon         -0.66980002 -0.14254532  0.10188925  0.870123440
Pennsylvania   -0.34510472 -0.78496898  0.45082502 -0.682898069
Rhode Island   -1.01768785  0.03927269  1.49763233 -1.394699594
South Carolina  1.53348953  1.31199880 -1.22406668  0.136752172
South Dakota   -0.92491776 -1.02739300 -1.43342815 -0.909380373
Tennessee       1.25517927  0.20896951 -0.45640799  0.611286522
Texas           1.13921666  0.36654512  1.00912225  0.460298320
Utah           -1.06407289 -0.61527217  1.00912225  0.179891658
Vermont        -1.29599811 -1.48799864 -2.34066115 -1.081938318
Virginia        0.16513075 -0.17890893 -0.17725937 -0.057375517
Washington     -0.87853272 -0.31224214  0.52061217  0.535792421
West Virginia  -0.48425985 -1.08799901 -1.85215107 -1.286850878
Wisconsin      -1.20322802 -1.42739264  0.03210209 -1.125077805
Wyoming        -0.22914211 -0.11830292 -0.38662083 -0.607403968</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We check the weights of the columns</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>acp_res<span class="sc">$</span>cw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We get the weight of the rows</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>acp_res<span class="sc">$</span>lw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02
[16] 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02
[31] 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02
[46] 0.02 0.02 0.02 0.02 0.02</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We get the coordinates of the rows</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>acp_res<span class="sc">$</span>li</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Axis1       Axis2       Axis3
Alabama        -0.98556588  1.13339238 -0.44426879
Alaska         -1.95013775  1.07321326  2.04000333
Arizona        -1.76316354 -0.74595678  0.05478082
Arkansas        0.14142029  1.11979678  0.11457369
California     -2.52398013 -1.54293399  0.59855680
Colorado       -1.51456286 -0.98755509  1.09500699
Connecticut     1.35864746 -1.08892789 -0.64325757
Delaware       -0.04770931 -0.32535892 -0.71863294
Florida        -3.01304227  0.03922851 -0.57682949
Georgia        -1.63928304  1.27894240 -0.34246008
Hawaii          0.91265715 -1.57046001  0.05078189
Idaho           1.63979985  0.21097292  0.25980134
Illinois       -1.37891072 -0.68184119 -0.67749564
Indiana         0.50546136 -0.15156254  0.22805484
Iowa            2.25364607 -0.10405407  0.16456432
Kansas          0.79688112 -0.27016470  0.02555331
Kentucky        0.75085907  0.95844029 -0.02836942
Louisiana      -1.56481798  0.87105466 -0.78348036
Maine           2.39682949  0.37639158 -0.06568239
Maryland       -1.76336939  0.42765519 -0.15725013
Massachusetts   0.48616629 -1.47449650 -0.60949748
Michigan       -2.10844115 -0.15539682  0.38486858
Minnesota       1.69268181 -0.63226125  0.15307043
Mississippi    -0.99649446  2.39379599 -0.74080840
Missouri       -0.69678733 -0.26335479  0.37744383
Montana         1.18545191  0.53687437  0.24688932
Nebraska        1.26563654 -0.19395373  0.17557391
Nevada         -2.87439454 -0.77560020  1.16338049
New Hampshire   2.38391541 -0.01808229  0.03685539
New Jersey     -0.18156611 -1.44950571 -0.76445355
New Mexico     -1.98002375  0.14284878  0.18369218
New York       -1.68257738 -0.82318414 -0.64307509
North Carolina -1.12337861  2.22800338 -0.86357179
North Dakota    2.99222562  0.59911882  0.30127728
Ohio            0.22596542 -0.74223824 -0.03113912
Oklahoma        0.31178286 -0.28785421 -0.01530979
Oregon         -0.05912208 -0.54141145  0.93983298
Pennsylvania    0.88841582 -0.57110035 -0.40062871
Rhode Island    0.86377206 -1.49197842 -1.36994570
South Carolina -1.32072380  1.93340466 -0.30053779
South Dakota    1.98777484  0.82334324  0.38929333
Tennessee      -0.99974168  0.86025130  0.18808295
Texas          -1.35513821 -0.41248082 -0.49206886
Utah            0.55056526 -1.47150461  0.29372804
Vermont         2.80141174  1.40228806  0.84126309
Virginia        0.09633491  0.19973529  0.01171254
Washington      0.21690338 -0.97012418  0.62487094
West Virginia   2.10858541  1.42484670  0.10477467
Wisconsin       2.07971417 -0.61126862 -0.13886500
Wyoming         0.62942666  0.32101297 -0.24065923</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We get the coordinates standarized of the rows</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>acp_res<span class="sc">$</span>l1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       RS1         RS2         RS3
Alabama        -0.62580448  1.13923733 -0.74400791
Alaska         -1.23827840  1.07874786  3.41635214
Arizona        -1.11955544 -0.74980371  0.09174033
Arkansas        0.08979760  1.12557163  0.19187423
California     -1.60265093 -1.55089097  1.00239091
Colorado       -0.96170154 -0.99264795  1.83378597
Connecticut     0.86269998 -1.09454354 -1.07725038
Delaware       -0.03029397 -0.32703681 -1.20347999
Florida        -1.91319057  0.03943082 -0.96600463
Georgia        -1.04089508  1.28553796 -0.57351094
Hawaii          0.57950964 -1.57855894  0.08504341
Idaho           1.04122324  0.21206091  0.43508403
Illinois       -0.87556654 -0.68535747 -1.13458819
Indiana         0.32095265 -0.15234416  0.38191881
Iowa            1.43099699 -0.10459068  0.27559252
Kansas          0.50599537 -0.27155796  0.04279360
Kentucky        0.47677277  0.96338300 -0.04750969
Louisiana      -0.99361202  0.87554672 -1.31207864
Maine           1.52191412  0.37833264 -0.10999696
Maryland       -1.11968615  0.42986063 -0.26334359
Massachusetts   0.30870087 -1.48210054 -1.02071304
Michigan       -1.33879626 -0.15619821  0.64453160
Minnesota       1.07480168 -0.63552185  0.25634395
Mississippi    -0.63274380  2.40614090 -1.24061677
Missouri       -0.44243885 -0.26471292  0.63209751
Montana         0.75272605  0.53964306  0.41346053
Nebraska        0.80364087 -0.19495396  0.29403005
Nevada         -1.82515346 -0.77960000  1.94828968
New Hampshire   1.51371407 -0.01817554  0.06172098
New Jersey     -0.11528898 -1.45698088 -1.28021483
New Mexico     -1.25725511  0.14358546  0.30762556
New York       -1.06838567 -0.82742934 -1.07694480
North Carolina -0.71331139  2.23949329 -1.44620613
North Dakota    1.89997263  0.60220851  0.50454295
Ohio            0.14348120 -0.74606599 -0.05214805
Oklahoma        0.19797267 -0.28933868 -0.02563900
Oregon         -0.03754073 -0.54420354  1.57391920
Pennsylvania    0.56411714 -0.57404554 -0.67092476
Rhode Island    0.54846910 -1.49967262 -2.29422023
South Carolina -0.83861961  1.94337532 -0.50330453
South Dakota    1.26217681  0.82758926  0.65194163
Tennessee      -0.63480569  0.86468766  0.31497869
Texas          -0.86047171 -0.41460800 -0.82405772
Utah            0.34959226 -1.47909322  0.49190038
Vermont         1.77881160  1.40951972  1.40884621
Virginia        0.06116975  0.20076533  0.01961476
Washington      0.13772708 -0.97512716  1.04645867
West Virginia   1.33888786  1.43219470  0.17546401
Wisconsin       1.32055550 -0.61442096 -0.23255439
Wyoming         0.39966687  0.32266845 -0.40302713</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We get the coordinates of the columns</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>acp_res<span class="sc">$</span>co</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Comp1      Comp2      Comp3
Murder   -0.8439764  0.4160354 -0.2037600
Assault  -0.9184432  0.1870211 -0.1601192
UrbanPop -0.4381168 -0.8683282 -0.2257242
Rape     -0.8558394 -0.1664602  0.4883190</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We get the coordinates standarized of the columns</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>acp_res<span class="sc">$</span>c1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                CS1        CS2        CS3
Murder   -0.5358995  0.4181809 -0.3412327
Assault  -0.5831836  0.1879856 -0.2681484
UrbanPop -0.2781909 -0.8728062 -0.3780158
Rape     -0.5434321 -0.1673186  0.8177779</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We get a plot of the relation between the coordinates of the pca 1 vs variables</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">score</span>(acp_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/acp_arrests-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlations circle</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">s.corcircle</span>(acp_res<span class="sc">$</span>co)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/acp_arrests-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Principal plane</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">s.label</span>(acp_res<span class="sc">$</span>li)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/acp_arrests-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simmultanious correlation variables, and principal plane and value of eigen values</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(acp_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/acp_arrests-5.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="análisis-de-correspondencias-simples" class="level1">
<h1>Análisis de Correspondencias Simples</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We load the data</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(housetasks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We make a chi square test</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(housetasks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  housetasks
X-squared = 1944.5, df = 36, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Se recha la hipótesis nula de que no existe relación entre las variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We estimate the row profiles</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(housetasks <span class="sc">/</span> <span class="fu">apply</span>(housetasks, <span class="dv">1</span>, sum), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Wife Alternating Husband Jointly
Laundry    0.89        0.08    0.01    0.02
Main_meal  0.81        0.13    0.03    0.03
Dinner     0.71        0.10    0.06    0.12
Breakfeast 0.59        0.26    0.11    0.05
Tidying    0.43        0.09    0.01    0.47
Dishes     0.28        0.21    0.04    0.47
Shopping   0.28        0.19    0.07    0.46
Official   0.12        0.48    0.24    0.16
Driving    0.07        0.37    0.54    0.02
Finances   0.12        0.12    0.19    0.58
Insurance  0.06        0.01    0.38    0.55
Repairs    0.00        0.02    0.97    0.01
Holidays   0.00        0.01    0.04    0.96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We estimate the column profiles</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">t</span>(housetasks) <span class="sc">/</span> <span class="fu">apply</span>(<span class="fu">t</span>(housetasks), <span class="dv">1</span>, sum), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Laundry Main_meal Dinner Breakfeast Tidying Dishes Shopping
Wife           0.26      0.21   0.13       0.14    0.09   0.05     0.06
Alternating    0.06      0.08   0.04       0.14    0.04   0.09     0.09
Husband        0.01      0.01   0.02       0.04    0.00   0.01     0.02
Jointly        0.01      0.01   0.03       0.01    0.11   0.10     0.11
            Official Driving Finances Insurance Repairs Holidays
Wife            0.02    0.02     0.02      0.01    0.00     0.00
Alternating     0.18    0.20     0.05      0.00    0.01     0.00
Husband         0.06    0.20     0.06      0.14    0.42     0.02
Jointly         0.03    0.01     0.13      0.15    0.00     0.30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We estimate the weight of the rows</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">apply</span>(housetasks, <span class="dv">1</span>, sum) <span class="sc">/</span> <span class="fu">sum</span>(housetasks), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Laundry  Main_meal     Dinner Breakfeast    Tidying     Dishes   Shopping 
      0.10       0.09       0.06       0.08       0.07       0.06       0.07 
  Official    Driving   Finances  Insurance    Repairs   Holidays 
      0.06       0.08       0.06       0.08       0.09       0.09 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We estima the weight of the columns</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">apply</span>(housetasks, <span class="dv">2</span>, sum) <span class="sc">/</span> <span class="fu">sum</span>(housetasks), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Wife Alternating     Husband     Jointly 
       0.34        0.15        0.22        0.29 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We make a afc</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">dudi.coa</span>(<span class="at">df =</span> housetasks, <span class="at">scannf =</span> F, <span class="at">nf =</span> <span class="dv">3</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We get the eigen values</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(z<span class="sc">$</span>eig, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.54 0.45 0.13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inertia explained by each eigen value</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(z<span class="sc">$</span>eig <span class="sc">/</span> <span class="fu">sum</span>(z<span class="sc">$</span>eig) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 48.69 39.91 11.40</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We make the plot of the eigen values to check the inertia, and the inflection point</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>inercia <span class="ot">&lt;-</span> z<span class="sc">$</span>eig <span class="sc">/</span> <span class="fu">sum</span>(z<span class="sc">$</span>eig) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>), <span class="at">y =</span> inercia)) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Autovalor"</span>, <span class="at">y =</span> <span class="st">"% de inercia"</span>) <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Valor propios en %"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/plot%20eige%20values-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factorial plane</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(z, <span class="at">method =</span> <span class="dv">1</span>, <span class="at">sub =</span> <span class="st">"Tareas en el Hogar"</span>, <span class="at">posieig =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/factorial%20plane%20coa-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Second way to make factorial plane</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z<span class="sc">$</span>li[, <span class="dv">1</span>], z<span class="sc">$</span>li[, <span class="dv">2</span>], <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">"Axe 1"</span>, <span class="at">ylab =</span> <span class="st">"Axe 2"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.6</span>))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(z<span class="sc">$</span>li[, <span class="dv">1</span>], z<span class="sc">$</span>li[, <span class="dv">2</span>], <span class="at">label =</span> <span class="fu">row.names</span>(housetasks))</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(z<span class="sc">$</span>co[, <span class="dv">1</span>], z<span class="sc">$</span>co[, <span class="dv">2</span>], <span class="at">label =</span> <span class="fu">colnames</span>(housetasks), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Distribuci´on de Tareas en el Hogar"</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/factorial%20plane%20coa-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordinates of rows profiles</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(z<span class="sc">$</span>li, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Axis1 Axis2 Axis3
Laundry     0.99 -0.50 -0.32
Main_meal   0.88 -0.49 -0.16
Dinner      0.69 -0.31 -0.21
Breakfeast  0.51 -0.45  0.22
Tidying     0.39  0.43 -0.09
Dishes      0.19  0.44  0.27
Shopping    0.12  0.40  0.20
Official   -0.23 -0.25  0.92
Driving    -0.74 -0.65  0.54
Finances   -0.27  0.62  0.03
Insurance  -0.65  0.47 -0.29
Repairs    -1.53 -0.86 -0.47
Holidays   -0.25  1.44 -0.13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordinates of columns profiles</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(z<span class="sc">$</span>co, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Comp1 Comp2 Comp3
Wife         0.84 -0.37 -0.20
Alternating  0.06 -0.29  0.85
Husband     -1.16 -0.60 -0.19
Jointly     -0.15  1.03 -0.05</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We estimate the contribution of the columns to the inertia</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inertia.dudi</span>(z, <span class="at">col.inertia =</span> T)<span class="sc">$</span>col.abs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Axis1     Axis2      Axis3
Wife        44.462018 10.312237 10.8220753
Alternating  0.103739  2.782794 82.5492464
Husband     54.233879 17.786612  6.1331792
Jointly      1.200364 69.118357  0.4954991</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We estimate the contribution of the rows to the inertia</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inertia.dudi</span>(z, <span class="at">row.inertia =</span> T)<span class="sc">$</span>row.abs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Axis1      Axis2       Axis3
Laundry    18.2867003  5.5638913  7.96842443
Main_meal  12.3888433  4.7355230  1.85868941
Dinner      5.4713982  1.3210221  2.09692603
Breakfeast  3.8249284  3.6986131  3.06939857
Tidying     1.9983518  2.9656441  0.48873403
Dishes      0.4261663  2.8441170  3.63429434
Shopping    0.1755248  2.5151584  2.22335679
Official    0.5207837  0.7956201 36.94038942
Driving     8.0778371  7.6468564 18.59638635
Finances    0.8750075  5.5585460  0.06175066
Insurance   6.1470616  4.0203590  5.25263863
Repairs    40.7300940 15.8806509 16.59639139
Holidays    1.0773030 42.4539986  1.21261994</code></pre>
</div>
</div>
<ol start="11" type="a">
<li></li>
</ol>
<section id="ejercicio-3-capítulo-4" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-3-capítulo-4">Ejercicio 3 capítulo 4</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We read the data</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>profesiones <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"Ejercicios-Cap4.xlsx"</span>, <span class="dv">1</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We make the afc</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(profesiones) <span class="ot">&lt;-</span> profesiones[, <span class="dv">1</span>]</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>profesiones <span class="ot">&lt;-</span> profesiones[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>profesiones_coa <span class="ot">&lt;-</span> <span class="fu">dudi.coa</span>(<span class="at">df =</span> profesiones, <span class="at">scannf =</span> F, <span class="at">nf =</span> <span class="dv">4</span>)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(profesiones_coa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/exercise_4_3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Se puede observar que las amas de casa claramente se oponene a los profesores y maestros, así como los profes. liberalres y científicas teniéndose que los maestros aportan en su gran mayoría a la respuesta de que está en total desacuerdo de con el “FMI ayude a resolver la crisis”. Los otros que se oponen a estos últimos respecto al segundo eje y estos aportan en su gran mayoría con estar no tan de acuerdo. Además, en su gran mayoría las amas de casa aportan a la respuesta de podría estar de acuerdo. Las profesiones intermedias, empleados, patrón empresa o comercio, y agricultores no se ven tan bien representados en este plano.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factorial plane 3-4</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(, ) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> profesiones_coa<span class="sc">$</span>li[, <span class="dv">3</span>], <span class="at">y =</span> profesiones_coa<span class="sc">$</span>li[, <span class="dv">4</span>], <span class="at">label =</span> <span class="fu">rownames</span>(profesiones))) <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> profesiones_coa<span class="sc">$</span>co[, <span class="dv">3</span>], <span class="at">y =</span> profesiones_coa<span class="sc">$</span>co[, <span class="dv">4</span>], <span class="at">label =</span> <span class="fu">colnames</span>(profesiones))) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Eje 3"</span>, <span class="at">y =</span> <span class="st">"Eje 4"</span>) <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Plano factorial 3-4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Se puede observar como los agricultores y los patrones de empresa o comercio se encuentran del mismo lado en el plano factorial 3-4. Vamos a graficar los perfiles fila mediante un barplot para ver si esto es cierto</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We estimate the row profiles</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>row_profiles_profesiones <span class="ot">&lt;-</span> profesiones <span class="sc">/</span> <span class="fu">apply</span>(profesiones, <span class="dv">1</span>, sum)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>row_profiles_profesiones<span class="sc">$</span>profesion <span class="ot">&lt;-</span> <span class="fu">rownames</span>(row_profiles_profesiones)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>row_profiles_profesiones <span class="ot">&lt;-</span> row_profiles_profesiones <span class="sc">%&gt;%</span> <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"Respuesta"</span>, <span class="at">value =</span> <span class="st">"Valor"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>row_profiles_profesiones <span class="sc">%&gt;%</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(profesion <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Agricultures "</span>, <span class="st">"Patrón empresa o comercio "</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Respuesta, <span class="at">y =</span> Valor, <span class="at">fill =</span> profesion)) <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(. <span class="sc">~</span> profesion) <span class="sc">+</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Profesión"</span>, <span class="at">x =</span> <span class="st">"Respuesta"</span>, <span class="at">y =</span> <span class="st">"Valor"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/barplot%20patron%20empresa%20y%20agricultores-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Se puede observar que de cierta forma sí tienen un comportamiento similar tanto los agricultores omo los patrones de empresas o comercios. Tal y como lo proponía el plano factorial 3-4.</p>
</section>
<section id="ejercicio-4-capítulo-4" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-4-capítulo-4">Ejercicio 4 capítulo 4</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>exportaciones <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"Ejercicios-Cap4.xlsx"</span>, <span class="dv">2</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(exportaciones) <span class="ot">&lt;-</span> exportaciones[, <span class="dv">1</span>]</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>exportaciones <span class="ot">&lt;-</span> exportaciones[, <span class="sc">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se encuentra que sobre esta tabla de datos se puede realizar un AFC ya que a pesar de que fue ideado para describir la relación de dos variables cualitativas a través de tablas de contingencias el único requisito necesario es que las entradas de la tabla no sean negativas y que la suma de columnas y filas no se anule.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>exportaciones_coa <span class="ot">&lt;-</span> <span class="fu">dudi.coa</span>(<span class="at">df =</span> exportaciones, <span class="at">scannf =</span> F, <span class="at">nf =</span> <span class="dv">4</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(exportaciones_coa, <span class="at">posieig =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>exportaciones_pca <span class="ot">&lt;-</span> <span class="fu">dudi.pca</span>(<span class="at">df =</span> exportaciones, <span class="at">scannf =</span> F, <span class="at">nf =</span> <span class="dv">4</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(exportaciones_pca, <span class="at">posieig =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<p>En este caso se puede encontrar un comportamiento similar para los años, más no exactamente igual en términos de correlación. Ahora en cuanto a los productos se encuentra que en el ACP la mayoría de los cultivos se encuentran cercanos, situación que no sucede en el AFC que presentan un comportamiento de mayor dispersión.</p>
</section>
</section>
<section id="análisis-de-correspondencias-múltiples" class="level1">
<h1>Análisis de correspondencias múltiples</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We load the data</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ours)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We show the table</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>ours</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   altit deniv cloiso domain boise hetra favor inexp citat depart
1      2     3      3      2     2     3     3     2     1     HS
2      1     2      1      2     1     1     2     2     2     HS
3      3     3      3      2     2     2     3     3     2     HS
4      3     3      3      1     3     3     3     2     3     HS
5      3     3      1      2     2     3     2     3     1      S
6      3     3      3      1     3     3     3     3     3      S
7      2     2      3      2     2     1     2     3     1      S
8      1     1      2      2     1     1     3     2     2      S
9      2     3      1      2     3     2     3     3     4      S
10     2     2      3      1     3     3     2     3     1      S
11     1     1      1      1     1     1     2     2     1      S
12     2     2      3      1     3     3     3     2     3      I
13     2     3      3      1     3     3     3     2     3      I
14     1     3      2      2     1     1     1     3     2      I
15     2     2      1      3     2     2     2     2     1      I
16     3     3      3      3     3     3     3     3     4      I
17     3     1      3      3     3     3     3     1     4      D
18     3     2      3      3     3     3     2     2     4      D
19     2     1      1      3     3     3     3     1     4      D
20     2     1      1      2     2     2     1     1     2      D
21     2     1      1      2     2     2     1     1     1      D
22     1     1      1      2     1     1     1     1     2     HP
23     2     2      2      2     1     1     1     1     2     HP
24     1     1      3      3     1     1     1     1     1     HP
25     2     3      2      3     2     1     1     1     1     HP
26     2     2      1      1     2     1     1     1     1     HP
27     2     2      3      1     1     1     1     1     1     HP
28     3     2      1      3     3     3     2     1     1     HP
29     2     1      1      2     2     1     1     1     1     HP
30     1     1      3      3     1     1     2     1     1    AHP
31     3     1      3      3     2     3     2     1     1    AHP
32     3     2      3      3     2     1     2     1     1    AHP
33     3     2      3      3     2     1     1     1     1    AHP
34     3     1      3      1     3     3     1     1     1    AHP
35     1     2      3      3     1     1     1     1     1     AM
36     2     2      3      3     2     1     1     1     1     AM
37     3     1      3      3     3     1     1     1     1     AM
38     2     3      3      3     2     1     2     2     1     AM</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We show a summary of the data</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> altit  deniv  cloiso domain boise  hetra  favor  inexp  citat  depart 
 1: 8   1:13   1:12   1: 9   1:10   1:19   1:15   1:20   1:22   AHP:5  
 2:17   2:14   2: 4   2:13   2:15   2: 5   2:12   2:10   2: 7   AM :4  
 3:13   3:11   3:22   3:16   3:13   3:14   3:11   3: 8   3: 4   D  :5  
                                                         4: 5   HP :8  
                                                                HS :4  
                                                                I  :5  
                                                                S  :7  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We make a dispersion plot, boxplot</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">dudi.acm</span>(ours, <span class="at">scan =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/acm%20ours-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We make the disjuntive code</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>our_disyuntivo <span class="ot">&lt;-</span> <span class="fu">acm.disjonctif</span>(ours)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We make a burt table</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">acm.burt</span>(ours, ours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           altit.1 altit.2 altit.3 deniv.1 deniv.2 deniv.3 cloiso.1 cloiso.2
altit.1          8       0       0       5       2       1        3        2
altit.2          0      17       0       4       8       5        7        2
altit.3          0       0      13       4       4       5        2        0
deniv.1          5       4       4      13       0       0        6        1
deniv.2          2       8       4       0      14       0        4        1
deniv.3          1       5       5       0       0      11        2        2
cloiso.1         3       7       2       6       4       2       12        0
cloiso.2         2       2       0       1       1       2        0        4
cloiso.3         3       8      11       6       9       7        0        0
domain.1         1       5       3       2       4       3        2        0
domain.2         4       7       2       5       3       5        7        3
domain.3         3       5       8       6       7       3        3        1
boise.1          8       2       0       5       4       1        3        3
boise.2          0      10       5       4       6       5        6        1
boise.3          0       5       8       4       4       5        3        0
hetra.1          8       8       3       7       9       3        5        4
hetra.2          0       4       1       2       1       2        4        0
hetra.3          0       5       9       4       4       6        3        0
favor.1          4       8       3       7       6       2        5        3
favor.2          3       4       5       3       7       2        5        0
favor.3          1       5       5       3       1       7        2        1
inexp.1          4       9       7      11       8       1        7        2
inexp.2          3       5       2       2       4       4        3        1
inexp.3          1       3       4       0       2       6        2        1
citat.1          4      11       7       8      10       4        7        1
citat.2          4       2       1       3       2       2        3        3
citat.3          0       2       2       0       1       3        0        0
citat.4          0       2       3       2       1       2        2        0
depart.AHP       1       0       4       3       2       0        0        0
depart.AM        1       2       1       1       2       1        0        0
depart.D         0       3       2       4       1       0        3        0
depart.HP        2       5       1       3       4       1        4        2
depart.HS        1       1       2       0       1       3        1        0
depart.I         1       3       1       0       2       3        1        1
depart.S         2       3       2       2       2       3        3        1
           cloiso.3 domain.1 domain.2 domain.3 boise.1 boise.2 boise.3 hetra.1
altit.1           3        1        4        3       8       0       0       8
altit.2           8        5        7        5       2      10       5       8
altit.3          11        3        2        8       0       5       8       3
deniv.1           6        2        5        6       5       4       4       7
deniv.2           9        4        3        7       4       6       4       9
deniv.3           7        3        5        3       1       5       5       3
cloiso.1          0        2        7        3       3       6       3       5
cloiso.2          0        0        3        1       3       1       0       4
cloiso.3         22        7        3       12       4       8      10      10
domain.1          7        9        0        0       2       1       6       3
domain.2          3        0       13        0       5       7       1       7
domain.3         12        0        0       16       3       7       6       9
boise.1           4        2        5        3      10       0       0      10
boise.2           8        1        7        7       0      15       0       8
boise.3          10        6        1        6       0       0      13       1
hetra.1          10        3        7        9      10       8       1      19
hetra.2           1        0        4        1       0       4       1       0
hetra.3          11        6        2        6       0       3      11       0
favor.1           7        3        6        6       6       7       2      12
favor.2           7        2        3        7       3       6       3       6
favor.3           8        4        4        3       1       2       8       1
inexp.1          11        3        5       12       6       9       5      13
inexp.2           6        4        3        3       3       3       4       4
inexp.3           5        2        5        1       1       3       4       2
citat.1          14        5        5       12       5      13       4      14
citat.2           1        0        7        0       5       2       0       5
citat.3           4        4        0        0       0       0       4       0
citat.4           3        0        1        4       0       0       5       0
depart.AHP        5        1        0        4       1       3       1       3
depart.AM         4        0        0        4       1       2       1       4
depart.D          2        0        2        3       0       2       3       0
depart.HP         2        2        3        3       4       3       1       7
depart.HS         3        1        3        0       1       2       1       1
depart.I          3        2        1        2       1       1       3       1
depart.S          3        3        4        0       2       2       3       3
           hetra.2 hetra.3 favor.1 favor.2 favor.3 inexp.1 inexp.2 inexp.3
altit.1          0       0       4       3       1       4       3       1
altit.2          4       5       8       4       5       9       5       3
altit.3          1       9       3       5       5       7       2       4
deniv.1          2       4       7       3       3      11       2       0
deniv.2          1       4       6       7       1       8       4       2
deniv.3          2       6       2       2       7       1       4       6
cloiso.1         4       3       5       5       2       7       3       2
cloiso.2         0       0       3       0       1       2       1       1
cloiso.3         1      11       7       7       8      11       6       5
domain.1         0       6       3       2       4       3       4       2
domain.2         4       2       6       3       4       5       3       5
domain.3         1       6       6       7       3      12       3       1
boise.1          0       0       6       3       1       6       3       1
boise.2          4       3       7       6       2       9       3       3
boise.3          1      11       2       3       8       5       4       4
hetra.1          0       0      12       6       1      13       4       2
hetra.2          5       0       2       1       2       2       1       2
hetra.3          0      14       1       5       8       5       5       4
favor.1          2       1      15       0       0      14       0       1
favor.2          1       5       0      12       0       4       5       3
favor.3          2       8       0       0      11       2       5       4
inexp.1          2       5      14       4       2      20       0       0
inexp.2          1       5       0       5       5       0      10       0
inexp.3          2       4       1       3       4       0       0       8
citat.1          2       6      11      10       1      15       4       3
citat.2          2       0       4       1       2       3       2       2
citat.3          0       4       0       0       4       0       3       1
citat.4          1       4       0       1       4       2       1       2
depart.AHP       0       2       2       3       0       5       0       0
depart.AM        0       0       3       1       0       3       1       0
depart.D         2       3       2       1       2       4       1       0
depart.HP        0       1       7       1       0       8       0       0
depart.HS        1       2       0       1       3       0       3       1
depart.I         1       3       1       1       3       0       3       2
depart.S         1       3       0       4       3       0       2       5
           citat.1 citat.2 citat.3 citat.4 depart.AHP depart.AM depart.D
altit.1          4       4       0       0          1         1        0
altit.2         11       2       2       2          0         2        3
altit.3          7       1       2       3          4         1        2
deniv.1          8       3       0       2          3         1        4
deniv.2         10       2       1       1          2         2        1
deniv.3          4       2       3       2          0         1        0
cloiso.1         7       3       0       2          0         0        3
cloiso.2         1       3       0       0          0         0        0
cloiso.3        14       1       4       3          5         4        2
domain.1         5       0       4       0          1         0        0
domain.2         5       7       0       1          0         0        2
domain.3        12       0       0       4          4         4        3
boise.1          5       5       0       0          1         1        0
boise.2         13       2       0       0          3         2        2
boise.3          4       0       4       5          1         1        3
hetra.1         14       5       0       0          3         4        0
hetra.2          2       2       0       1          0         0        2
hetra.3          6       0       4       4          2         0        3
favor.1         11       4       0       0          2         3        2
favor.2         10       1       0       1          3         1        1
favor.3          1       2       4       4          0         0        2
inexp.1         15       3       0       2          5         3        4
inexp.2          4       2       3       1          0         1        1
inexp.3          3       2       1       2          0         0        0
citat.1         22       0       0       0          5         4        1
citat.2          0       7       0       0          0         0        1
citat.3          0       0       4       0          0         0        0
citat.4          0       0       0       5          0         0        3
depart.AHP       5       0       0       0          5         0        0
depart.AM        4       0       0       0          0         4        0
depart.D         1       1       0       3          0         0        5
depart.HP        6       2       0       0          0         0        0
depart.HS        1       2       1       0          0         0        0
depart.I         1       1       2       1          0         0        0
depart.S         4       1       1       1          0         0        0
           depart.HP depart.HS depart.I depart.S
altit.1            2         1        1        2
altit.2            5         1        3        3
altit.3            1         2        1        2
deniv.1            3         0        0        2
deniv.2            4         1        2        2
deniv.3            1         3        3        3
cloiso.1           4         1        1        3
cloiso.2           2         0        1        1
cloiso.3           2         3        3        3
domain.1           2         1        2        3
domain.2           3         3        1        4
domain.3           3         0        2        0
boise.1            4         1        1        2
boise.2            3         2        1        2
boise.3            1         1        3        3
hetra.1            7         1        1        3
hetra.2            0         1        1        1
hetra.3            1         2        3        3
favor.1            7         0        1        0
favor.2            1         1        1        4
favor.3            0         3        3        3
inexp.1            8         0        0        0
inexp.2            0         3        3        2
inexp.3            0         1        2        5
citat.1            6         1        1        4
citat.2            2         2        1        1
citat.3            0         1        2        1
citat.4            0         0        1        1
depart.AHP         0         0        0        0
depart.AM          0         0        0        0
depart.D           0         0        0        0
depart.HP          8         0        0        0
depart.HS          0         4        0        0
depart.I           0         0        5        0
depart.S           0         0        0        7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ACM results</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>ours_acm <span class="ot">&lt;-</span> <span class="fu">dudi.acm</span>(ours, <span class="at">scann =</span> <span class="cn">FALSE</span>, <span class="at">nf =</span> <span class="dv">3</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We check the eigen values</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(ours_acm<span class="sc">$</span>cr, <span class="dv">2</span>, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      RS1       RS2       RS3 
0.4458097 0.3228212 0.2500239 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>ours_acm<span class="sc">$</span>eig[<span class="dv">1</span><span class="sc">:</span>ours_acm<span class="sc">$</span>nf]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4458097 0.3228212 0.2500239</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of eigen values</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>inercia <span class="ot">&lt;-</span> ours_acm<span class="sc">$</span>eig <span class="sc">/</span> <span class="fu">sum</span>(ours_acm<span class="sc">$</span>eig) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(inercia, <span class="at">ylab =</span> <span class="st">"% de inercia"</span>, <span class="at">names.arg =</span> <span class="fu">round</span>(inercia, <span class="dv">2</span>))</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Valor propios en %"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/acm%20ours-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factorial plane representation</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ours_acm<span class="sc">$</span>li[, <span class="dv">1</span>], ours_acm<span class="sc">$</span>li[, <span class="dv">2</span>], <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">"Axe 1"</span>, <span class="at">ylab =</span> <span class="st">"Axe 2"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.6</span>))</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(ours_acm<span class="sc">$</span>li[, <span class="dv">1</span>], ours_acm<span class="sc">$</span>li[, <span class="dv">2</span>], <span class="at">label =</span> <span class="fu">row.names</span>(ours))</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(ours_acm<span class="sc">$</span>co[, <span class="dv">1</span>], ours_acm<span class="sc">$</span>co[, <span class="dv">2</span>], <span class="at">label =</span> <span class="fu">colnames</span>(our_disyuntivo), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Distribución de 38 Osos"</span>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/acm%20ours-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Main plane with intensities</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">s.value</span>(ours_acm<span class="sc">$</span>li, ours_acm<span class="sc">$</span>li[, <span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/acm%20ours-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">acm.burt</span>(ours, ours)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>bbcoa <span class="ot">&lt;-</span> <span class="fu">dudi.coa</span>(bb, <span class="at">scann =</span> <span class="cn">FALSE</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ours_acm<span class="sc">$</span>c1[, <span class="dv">1</span>], bbcoa<span class="sc">$</span>c1[, <span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/comparacion%20acm%20Burt%20y%20disyuntiva-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>bd <span class="ot">&lt;-</span> <span class="fu">acm.disjonctif</span>(ours)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>bdcoa <span class="ot">&lt;-</span> <span class="fu">dudi.coa</span>(bd, <span class="at">scann =</span> <span class="cn">FALSE</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ours_acm<span class="sc">$</span>li[, <span class="dv">1</span>], bdcoa<span class="sc">$</span>li[, <span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/comparacion%20acm%20Burt%20y%20disyuntiva-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ours_acm<span class="sc">$</span>co[, <span class="dv">1</span>], <span class="fu">dudi.coa</span>(bd, <span class="at">scann =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>co[, <span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/comparacion%20acm%20Burt%20y%20disyuntiva-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="13" type="a">
<li></li>
</ol>
<section id="ejercicio-6-del-capítulo-5" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-6-del-capítulo-5">Ejercicio 6 del capítulo 5</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>df_ejercicio_6_cap_5 <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"./Ejercicios-Cap5.xlsx"</span>, <span class="dv">1</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>perros <span class="ot">&lt;-</span> df_ejercicio_6_cap_5 <span class="sc">%&gt;%</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Raza) <span class="sc">%&gt;%</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), as.factor))</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>perros_acm <span class="ot">&lt;-</span> <span class="fu">dudi.acm</span>(<span class="at">df =</span> perros[, <span class="sc">-</span><span class="dv">7</span>], <span class="at">scann =</span> <span class="cn">FALSE</span>, <span class="at">nf =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se procede a ver los autovalores el grado de incercia explicada por cada uno</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We make a plot of the inertia</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>(inercia <span class="ot">&lt;-</span> perros_acm<span class="sc">$</span>eig <span class="sc">/</span> <span class="fu">sum</span>(perros_acm<span class="sc">$</span>eig) <span class="sc">*</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 24.4663585 19.9164674 12.3136391 10.6449215  8.5909715  7.4596115
 [7]  5.3903219  3.8915000  3.7371154  2.2088453  1.0205833  0.3596645</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cumsum</span>(inercia)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  24.46636  44.38283  56.69647  67.34139  75.93236  83.39197  88.78229
 [8]  92.67379  96.41091  98.61975  99.64034 100.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(inercia, <span class="at">ylab =</span> <span class="st">"% de inercia"</span>, <span class="at">names.arg =</span> <span class="fu">round</span>(inercia, <span class="dv">2</span>))</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Valor propios en %"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/inercia%20perros-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Si se pone como regla general que se tenga una inercia mayor a 75% entonces se pueden conservar los primeros 5 ejes. Además, se tiene que los que superan 100/12 = 8.3333333 en inercia, entonces se conservaría igualmente hasta el quinto.</p>
<p>Graficando se obtiene</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>perros_disyuntivo <span class="ot">&lt;-</span> <span class="fu">acm.disjonctif</span>(perros[, <span class="sc">-</span><span class="dv">7</span>])</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(perros) <span class="ot">&lt;-</span> df_ejercicio_6_cap_5<span class="sc">$</span>Raza</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Factorial plane representation</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perros_acm<span class="sc">$</span>li[, <span class="dv">1</span>], perros_acm<span class="sc">$</span>li[, <span class="dv">2</span>], <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">"Axe 1"</span>, <span class="at">ylab =</span> <span class="st">"Axe 2"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.6</span>))</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">jitter</span>(perros_acm<span class="sc">$</span>li[, <span class="dv">1</span>], <span class="at">amount =</span> <span class="fl">0.1</span>), <span class="fu">jitter</span>(perros_acm<span class="sc">$</span>li[, <span class="dv">2</span>], <span class="at">amount =</span> <span class="fl">0.1</span>), <span class="at">label =</span> <span class="fu">row.names</span>(perros))</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="co"># text((perros_acm$li[, 1]), (perros_acm$li[, 2]), label = row.names(perros))</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>((perros_acm<span class="sc">$</span>co[, <span class="dv">1</span>]), (perros_acm<span class="sc">$</span>co[, <span class="dv">2</span>]), <span class="at">label =</span> <span class="fu">colnames</span>(perros_disyuntivo), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Distribución de 27 razas de perros"</span>)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En este caso se agregó un poco de ruido ya que algunas razas se encontraban justamente por encima de las otras. Se puede observar que los chihuha y pekinés son colocados de forma cercana de tal forma que estos se encuentran principalmente caracterizados por ser livianos, lkentos y pequeños a ellos se contraponen los perros más grandes como es el Rottweiler por ejemplo que tiene talla velocidad y talla mayor. Se puede observar que muy pocos son los perros que son caracterizados principalmente por agresividad 1, inteligencia 2 y afecto 3.</p>
<p>Ahora si se grafica la variable suplementaria función se tiene lo siguiente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>funcion_suplementaria <span class="ot">&lt;-</span> <span class="fu">acm.disjonctif</span>(perros <span class="sc">%&gt;%</span> <span class="fu">select</span>(Func))</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>coord_funcion <span class="ot">&lt;-</span> <span class="fu">supcol</span>(<span class="at">x =</span> perros_acm, <span class="at">Xsup =</span> funcion_suplementaria)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perros_acm<span class="sc">$</span>li[, <span class="dv">1</span>], perros_acm<span class="sc">$</span>li[, <span class="dv">2</span>], <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">"Axe 1"</span>, <span class="at">ylab =</span> <span class="st">"Axe 2"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.6</span>))</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">jitter</span>(perros_acm<span class="sc">$</span>li[, <span class="dv">1</span>], <span class="at">amount =</span> <span class="fl">0.1</span>), <span class="fu">jitter</span>(perros_acm<span class="sc">$</span>li[, <span class="dv">2</span>], <span class="at">amount =</span> <span class="fl">0.1</span>), <span class="at">label =</span> <span class="fu">row.names</span>(perros))</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co"># text((perros_acm$li[, 1]), (perros_acm$li[, 2]), label = row.names(perros))</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>((perros_acm<span class="sc">$</span>co[, <span class="dv">1</span>]), (perros_acm<span class="sc">$</span>co[, <span class="dv">2</span>]), <span class="at">label =</span> <span class="fu">colnames</span>(perros_disyuntivo), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>((coord_funcion<span class="sc">$</span>cosup[, <span class="dv">1</span>]), (coord_funcion<span class="sc">$</span>cosup[, <span class="dv">1</span>]), <span class="at">label =</span> <span class="fu">colnames</span>(funcion_suplementaria), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Distribución de 27 razas de perros, primer plano factorial"</span>)</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/perros%20factorial%201-2%20suplementaria-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Se puede observar en este caso que compañía y utilidad se contraponen, sin embargo, se puede observar que caza no se ve tan bien reflejada en este plano. Además, se puede obsevar que los que más aportan a utilidad son los terranova, dogo alemán y San Bernardo. Mientras que en el caso de compañía en el mismo cuadrante se encuentran algunos muy alejados. Ahora si se grafica el tercer eje con el cuarto eje se obtiene lo siguiente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perros_acm<span class="sc">$</span>li[, <span class="dv">3</span>], perros_acm<span class="sc">$</span>li[, <span class="dv">4</span>], <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">"Axe 1"</span>, <span class="at">ylab =</span> <span class="st">"Axe 2"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.6</span>))</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">jitter</span>(perros_acm<span class="sc">$</span>li[, <span class="dv">3</span>], <span class="at">amount =</span> <span class="fl">0.1</span>), <span class="fu">jitter</span>(perros_acm<span class="sc">$</span>li[, <span class="dv">4</span>], <span class="at">amount =</span> <span class="fl">0.1</span>), <span class="at">label =</span> <span class="fu">row.names</span>(perros))</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co"># text((perros_acm$li[, 1]), (perros_acm$li[, 2]), label = row.names(perros))</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>((perros_acm<span class="sc">$</span>co[, <span class="dv">3</span>]), (perros_acm<span class="sc">$</span>co[, <span class="dv">4</span>]), <span class="at">label =</span> <span class="fu">colnames</span>(perros_disyuntivo), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>((coord_funcion<span class="sc">$</span>cosup[, <span class="dv">3</span>]), (coord_funcion<span class="sc">$</span>cosup[, <span class="dv">4</span>]), <span class="at">label =</span> <span class="fu">colnames</span>(funcion_suplementaria), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Distribución de 27 razas de perros, plano factorial 2-3"</span>)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/perros%20factorial%203-4%20suplementaria-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En este caso se puede ver más claramente la función de utilidad, que se puede observar caza se contrapone a utilidad teniendo que caza se ve mayoritariamente representado por el cuarto eje. Además, se encuentra que el que más le aporta en este caso a la posición son los Setter, perros los cuales realmente tienen como utilidad caza, lo cual termina siendo interesante ya que esta variable no fue incluida inicialmente en el ajuste del ACM.</p>
<ol start="14" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We read the data</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>df_itcr <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"./ComedorITCR-datos.xls"</span>)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Disjonctif code of itcr table first 9 columns</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>itcr_disyuntivo <span class="ot">&lt;-</span> <span class="fu">acm.disjonctif</span>(<span class="fu">as.data.frame</span>(df_itcr <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)))</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>itcr_acm <span class="ot">&lt;-</span> <span class="fu">dudi.acm</span>(<span class="at">df =</span> <span class="fu">as.data.frame</span>(df_itcr <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>))) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), as.factor)), <span class="at">scann =</span> <span class="cn">FALSE</span>, <span class="at">nf =</span> <span class="dv">5</span>)</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a><span class="co"># We are going to get the supplementart vary variable of disjointif code for qualitative</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="co"># variables</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_itcr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Rapidez"    "Hig. Inst." "Hig. Prod." "Variedad"   "Calidad"   
 [6] "Precios"    "Tamaño"     "Atención"   "Servicio"   "Razón"     
[11] "Edad"       "Sexo"       "Ocupación"  "CatEdad"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>disyuntivo_suplementarias <span class="ot">&lt;-</span> <span class="fu">acm.disjonctif</span>(<span class="fu">as.data.frame</span>(df_itcr <span class="sc">%&gt;%</span> <span class="fu">select</span>(Razón, Sexo, Ocupación)))</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>coord_suplementarias <span class="ot">&lt;-</span> <span class="fu">supcol</span>(<span class="at">x =</span> itcr_acm, <span class="at">Xsup =</span> disyuntivo_suplementarias)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>edad_sup <span class="ot">&lt;-</span> <span class="fu">data.frame</span>((df_itcr<span class="sc">$</span>Edad <span class="sc">-</span> <span class="fu">mean</span>(df_itcr<span class="sc">$</span>Edad)) <span class="sc">/</span> <span class="fu">sd</span>(df_itcr<span class="sc">$</span>Edad))</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>v_h <span class="ot">&lt;-</span> <span class="fu">supcol</span>(<span class="at">x =</span> itcr_acm, <span class="at">Xsup =</span> edad_sup)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>coord_vh_continua <span class="ot">&lt;-</span> v_h<span class="sc">$</span>cosup <span class="co"># / nrow(itcr_disyuntivo)</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="co"># We plot the variables, and the supplementary variables</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(itcr_acm<span class="sc">$</span>li[, <span class="dv">1</span>], itcr_acm<span class="sc">$</span>li[, <span class="dv">2</span>], <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">"Axe 1"</span>, <span class="at">ylab =</span> <span class="st">"Axe 2"</span>)</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(itcr_acm<span class="sc">$</span>li[, <span class="dv">1</span>], itcr_acm<span class="sc">$</span>li[, <span class="dv">2</span>], <span class="at">label =</span> <span class="fu">row.names</span>(df_itcr))</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(itcr_acm<span class="sc">$</span>co[, <span class="dv">1</span>], itcr_acm<span class="sc">$</span>co[, <span class="dv">2</span>], <span class="at">label =</span> <span class="fu">colnames</span>(itcr_disyuntivo), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(coord_suplementarias<span class="sc">$</span>cosup[, <span class="dv">1</span>], coord_suplementarias<span class="sc">$</span>cosup[, <span class="dv">2</span>], <span class="at">label =</span> <span class="fu">colnames</span>(disyuntivo_suplementarias), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(coord_vh_continua[<span class="dv">1</span>], coord_vh_continua[<span class="dv">2</span>], <span class="at">label =</span> <span class="st">"Edad"</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Distribución ITCR plano factorial 1-2"</span>)</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Se puede observar que en este la variable de edad no se ve la mejor forma representada. Se contraponen servicio 1 a rapidez 3, servicio 2 y tamaño 2. Además, se observar que los individuos se muestran realmente distribuidos a los largo de todos los ejes. Las variables suplementarias no se ven representadas de las mejor forma en este plano y sucede lo mismo que con edad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We plot the variables, and the supplementary variables in factorial plane 3-4</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(itcr_acm<span class="sc">$</span>li[, <span class="dv">3</span>], itcr_acm<span class="sc">$</span>li[, <span class="dv">4</span>], <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">"Axe 1"</span>, <span class="at">ylab =</span> <span class="st">"Axe 2"</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(itcr_acm<span class="sc">$</span>li[, <span class="dv">3</span>], itcr_acm<span class="sc">$</span>li[, <span class="dv">4</span>], <span class="at">label =</span> <span class="fu">row.names</span>(df_itcr))</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(itcr_acm<span class="sc">$</span>co[, <span class="dv">3</span>], itcr_acm<span class="sc">$</span>co[, <span class="dv">4</span>], <span class="at">label =</span> <span class="fu">colnames</span>(itcr_disyuntivo), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(coord_suplementarias<span class="sc">$</span>cosup[, <span class="dv">3</span>], coord_suplementarias<span class="sc">$</span>cosup[, <span class="dv">4</span>], <span class="at">label =</span> <span class="fu">colnames</span>(disyuntivo_suplementarias), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(coord_vh_continua[<span class="dv">3</span>], coord_vh_continua[<span class="dv">4</span>], <span class="at">label =</span> <span class="st">"Edad"</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Distribución ITCR plano factorial 3-4"</span>)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_6_Joshua_Cervantes_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En este segundo plano se encuentra que en el plano factorial 3-4 se ven mejo representadas las variables suplementarias.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>