<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>laboratorio_5_joshua_cervantes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Laboratorio_5_Joshua_Cervantes_files/libs/clipboard/clipboard.min.js"></script>
<script src="Laboratorio_5_Joshua_Cervantes_files/libs/quarto-html/quarto.js"></script>
<script src="Laboratorio_5_Joshua_Cervantes_files/libs/quarto-html/popper.min.js"></script>
<script src="Laboratorio_5_Joshua_Cervantes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Laboratorio_5_Joshua_Cervantes_files/libs/quarto-html/anchor.min.js"></script>
<link href="Laboratorio_5_Joshua_Cervantes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Laboratorio_5_Joshua_Cervantes_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Laboratorio_5_Joshua_Cervantes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Laboratorio_5_Joshua_Cervantes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Laboratorio_5_Joshua_Cervantes_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<!-- R Commander Markdown Template -->
<section id="laboratorio-5" class="level1">
<h1>Laboratorio 5</h1>
<section id="joshua-cervantes-artavia" class="level3">
<h3 class="anchored" data-anchor-id="joshua-cervantes-artavia">Joshua Cervantes Artavia</h3>
</section>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">2023-10-03</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">data</span>(iris, <span class="at">package =</span> <span class="st">"datasets"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="iris" class="level1">
<h1>Iris</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris.PCA <span class="ot">&lt;-</span> iris[, <span class="fu">c</span>(<span class="st">"Sepal.Length"</span>, <span class="st">"Sepal.Width"</span>, <span class="st">"Petal.Length"</span>, <span class="st">"Petal.Width"</span>, <span class="st">"Species"</span>)]</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> res <span class="ot">&lt;-</span> <span class="fu">PCA</span>(iris.PCA, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, <span class="at">ncp =</span> <span class="dv">5</span>, <span class="at">quali.sup =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">5</span>), <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">plot.PCA</span>(res, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">choix =</span> <span class="st">"ind"</span>, <span class="at">habillage =</span> <span class="st">"none"</span>, <span class="at">col.ind =</span> <span class="st">"#0d1282"</span>, <span class="at">col.ind.sup =</span> <span class="st">"blue"</span>, <span class="at">col.quali =</span> <span class="st">"#d71313"</span>, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"ind"</span>, <span class="st">"ind.sup"</span>, <span class="st">"quali"</span>), <span class="at">new.plot =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Plano principal"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">plot.PCA</span>(res, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">choix =</span> <span class="st">"var"</span>, <span class="at">new.plot =</span> <span class="cn">TRUE</span>, <span class="at">col.var =</span> <span class="st">"black"</span>, <span class="at">col.quanti.sup =</span> <span class="st">"blue"</span>, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"var"</span>, <span class="st">"quanti.sup"</span>), <span class="at">lim.cos2.var =</span> <span class="dv">0</span>, <span class="at">title =</span> <span class="st">"Círculo de correlaciones"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="pca_ind_iris.svg" class="img-fluid"></p>
<p><img src="pca_iris.svg" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(res, <span class="at">nb.dec =</span> <span class="dv">3</span>, <span class="at">nbelements =</span> <span class="dv">10</span>, <span class="at">nbind =</span> <span class="dv">10</span>, <span class="at">ncp =</span> <span class="dv">3</span>, <span class="at">file =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
PCA(X = iris.PCA, scale.unit = TRUE, ncp = 5, quali.sup = c(5:5),  
     graph = FALSE) 


Eigenvalues
                       Dim.1   Dim.2   Dim.3   Dim.4
Variance               2.918   0.914   0.147   0.021
% of var.             72.962  22.851   3.669   0.518
Cumulative % of var.  72.962  95.813  99.482 100.000

Individuals (the 10 first)
                 Dist    Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3
1            |  2.319 | -2.265  1.172  0.954 |  0.480  0.168  0.043 | -0.128
2            |  2.202 | -2.081  0.989  0.893 | -0.674  0.331  0.094 | -0.235
3            |  2.389 | -2.364  1.277  0.979 | -0.342  0.085  0.020 |  0.044
4            |  2.378 | -2.299  1.208  0.935 | -0.597  0.260  0.063 |  0.091
5            |  2.476 | -2.390  1.305  0.932 |  0.647  0.305  0.068 |  0.016
6            |  2.555 | -2.076  0.984  0.660 |  1.489  1.617  0.340 |  0.027
7            |  2.468 | -2.444  1.364  0.981 |  0.048  0.002  0.000 |  0.335
8            |  2.246 | -2.233  1.139  0.988 |  0.223  0.036  0.010 | -0.089
9            |  2.592 | -2.335  1.245  0.812 | -1.115  0.907  0.185 |  0.145
10           |  2.249 | -2.184  1.090  0.943 | -0.469  0.160  0.043 | -0.254
                ctr   cos2  
1             0.074  0.003 |
2             0.250  0.011 |
3             0.009  0.000 |
4             0.038  0.001 |
5             0.001  0.000 |
6             0.003  0.000 |
7             0.511  0.018 |
8             0.036  0.002 |
9             0.096  0.003 |
10            0.293  0.013 |

Variables
                Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3    ctr
Sepal.Length |  0.890 27.151  0.792 |  0.361 14.244  0.130 | -0.276 51.778
Sepal.Width  | -0.460  7.255  0.212 |  0.883 85.247  0.779 |  0.094  5.972
Petal.Length |  0.992 33.688  0.983 |  0.023  0.060  0.001 |  0.054  2.020
Petal.Width  |  0.965 31.906  0.931 |  0.064  0.448  0.004 |  0.243 40.230
               cos2  
Sepal.Length  0.076 |
Sepal.Width   0.009 |
Petal.Length  0.003 |
Petal.Width   0.059 |

Supplementary categories
                  Dist     Dim.1    cos2  v.test     Dim.2    cos2  v.test  
setosa       |   2.244 |  -2.225   0.983 -11.240 |   0.289   0.017   2.608 |
versicolor   |   0.748 |   0.496   0.441   2.508 |  -0.550   0.541  -4.967 |
virginica    |   1.753 |   1.728   0.971   8.732 |   0.261   0.022   2.359 |
               Dim.3    cos2  v.test  
setosa        -0.043   0.000  -0.965 |
versicolor    -0.096   0.017  -2.166 |
virginica      0.139   0.006   3.131 |</code></pre>
</div>
</div>
</section>
<section id="tabla-4.10" class="level1">
<h1>Tabla 4.10</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> profesion_respuesta <span class="ot">&lt;-</span> <span class="fu">readXL</span>(<span class="st">"C:/Users/saac9/OneDrive - Universidad de Costa Rica/Documents/UCR/2023/Topicos_de_analisis_de_datos_1/Laboratorios/Ejercicios-Cap4.xlsx"</span>,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     <span class="at">rownames =</span> <span class="cn">TRUE</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">na =</span> <span class="st">""</span>, <span class="at">sheet =</span> <span class="st">"3.Profesión-FMI"</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> profesion_respuesta.CA <span class="ot">&lt;-</span> profesion_respuesta[<span class="fu">c</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     <span class="st">"Agricultures"</span>, <span class="st">"Patrón empresa o comercio"</span>, <span class="st">"Profes. liberales y científicas"</span>, <span class="st">"Empleados"</span>, <span class="st">"Profesiones intermedias"</span>, <span class="st">"Profesores y maestros"</span>, <span class="st">"Estudiantes"</span>, <span class="st">"Pensionados"</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     <span class="st">"Amas de casa"</span>, <span class="st">"Desempleados, sin profesión"</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> ), <span class="fu">c</span>(<span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"X4"</span>, <span class="st">"X5"</span>)]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> res <span class="ot">&lt;-</span> <span class="fu">CA</span>(profesion_respuesta.CA, <span class="at">ncp =</span> <span class="dv">5</span>, <span class="at">row.sup =</span> <span class="cn">NULL</span>, <span class="at">col.sup =</span> <span class="cn">NULL</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">plot.CA</span>(res, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">col.row =</span> <span class="st">"blue"</span>, <span class="at">col.col =</span> <span class="st">"red"</span>, <span class="at">title =</span> <span class="st">"Plano factorial principal AFC"</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"col"</span>, <span class="st">"col.sup"</span>, <span class="st">"row"</span>, <span class="st">"row.sup"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_5_Joshua_Cervantes_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="750"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(res, <span class="at">nb.dec =</span> <span class="dv">3</span>, <span class="at">nbelements =</span> <span class="dv">10</span>, <span class="at">nbind =</span> <span class="dv">10</span>, <span class="at">ncp =</span> <span class="dv">3</span>, <span class="at">file =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
CA(X = profesion_respuesta.CA, ncp = 5, row.sup = NULL, col.sup = NULL,  
     graph = FALSE) 

The chi square of independence between the two variables is equal to 90.53325 (p-value =  1.362483e-06 ).

Eigenvalues
                       Dim.1   Dim.2   Dim.3   Dim.4
Variance               0.046   0.007   0.006   0.005
% of var.             72.527  10.392   9.857   7.225
Cumulative % of var.  72.527  82.919  92.775 100.000

Rows
                                  Iner*1000    Dim.1    ctr   cos2    Dim.2
Agricultures                    |     0.587 |  0.051  0.097  0.076 |  0.026
Patrón empresa o comercio       |     3.906 |  0.002  0.001  0.000 |  0.020
Profes. liberales y científicas |     9.479 |  0.409 19.349  0.935 | -0.087
Empleados                       |     0.146 |  0.001  0.001  0.003 | -0.003
Profesiones intermedias         |     3.909 |  0.089  0.841  0.099 | -0.014
Profesores y maestros           |     6.478 |  0.484 12.140  0.859 | -0.089
Estudiantes                     |    16.451 |  0.446 30.338  0.845 |  0.182
Pensionados                     |     2.773 |  0.052  0.286  0.047 | -0.188
Amas de casa                    |    17.155 | -0.226 36.619  0.978 |  0.023
Desempleados, sin profesión     |     2.294 |  0.097  0.328  0.066 | -0.327
                                   ctr   cos2    Dim.3    ctr   cos2  
Agricultures                     0.178  0.020 |  0.170  8.122  0.862 |
Patrón empresa o comercio        0.602  0.010 |  0.180 52.335  0.834 |
Profes. liberales y científicas  6.182  0.043 | -0.062  3.307  0.022 |
Empleados                        0.051  0.023 | -0.010  0.474  0.202 |
Profesiones intermedias          0.147  0.002 | -0.163 20.623  0.329 |
Profesores y maestros            2.866  0.029 |  0.165 10.350  0.099 |
Estudiantes                     35.116  0.140 | -0.046  2.349  0.009 |
Pensionados                     25.985  0.615 | -0.021  0.339  0.008 |
Amas de casa                     2.698  0.010 | -0.020  2.083  0.008 |
Desempleados, sin profesión     26.175  0.749 | -0.008  0.019  0.001 |

Columns
                                  Iner*1000    Dim.1    ctr   cos2    Dim.2
X1                              |    16.598 |  0.272 28.719  0.793 | -0.130
X2                              |    15.476 |  0.222 27.026  0.800 |  0.096
X3                              |    17.279 | -0.221 33.900  0.899 | -0.012
X4                              |     7.561 | -0.153  9.075  0.550 | -0.032
X5                              |     6.264 | -0.087  1.281  0.094 |  0.115
                                   ctr   cos2    Dim.3    ctr   cos2  
X1                              46.052  0.182 |  0.040  4.563  0.017 |
X2                              35.030  0.149 | -0.055 12.283  0.049 |
X3                               0.745  0.003 | -0.044  9.814  0.035 |
X4                               2.770  0.024 |  0.011  0.357  0.003 |
X5                              15.403  0.161 |  0.243 72.983  0.726 |</code></pre>
</div>
</div>
<p>En este caso se puede observar como se genera un grupo al rededor de la respuesta 1 que es en total desacuerdo de tal forma que este grupo aporta de mayor forma a la respuesta. Por otro lado se puede observar que las respuestas no tan de acuerdo y en total desacuerdo se cotraponen a todas la demás que se ven más asociadas a respuestas de amas de casa, patrones y empleados, aunque estos dos últimos parecen aportar lo mismo para los dos grupos de respuestas que se contraponen. En este caso se pueden conservar los autovalores que superen el 100/4 = 25 de varianza explicada (inercia), sin embargo, en ese caso conservaríamos únicamente el primer eje, en dado caso podrían tomarse los dos primeros y estos a su vez superan el 75% de inercia acumula que puede ser tomado como un criterio global para escogencia de los autovalores.</p>
</section>
<section id="tabla-4.11" class="level1">
<h1>Tabla 4.11</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> exportaciones_costa_rica <span class="ot">&lt;-</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     <span class="fu">readXL</span>(<span class="st">"C:/Users/saac9/OneDrive - Universidad de Costa Rica/Documents/UCR/2023/Topicos_de_analisis_de_datos_1/Laboratorios/Ejercicios-Cap4.xlsx"</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>         <span class="at">rownames =</span> <span class="cn">TRUE</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">na =</span> <span class="st">""</span>, <span class="at">sheet =</span> <span class="st">"4.Exportaciones"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> exportaciones_costa_rica.CA <span class="ot">&lt;-</span> exportaciones_costa_rica[<span class="fu">c</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     <span class="st">"Plantas ornamentales"</span>, <span class="st">"Flores"</span>, <span class="st">"Follajes"</span>, <span class="st">"Chayotes"</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     <span class="st">"Yuca"</span>, <span class="st">"Tubérculos"</span>, <span class="st">"Piñas"</span>, <span class="st">"Plátanos"</span>, <span class="st">"Macadamia"</span>, <span class="st">"Fresas"</span>, <span class="st">"Melones"</span>, <span class="st">"Papayas"</span>, <span class="st">"Petunia"</span>, <span class="st">"Raivilla"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     <span class="st">"Otros"</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> ), <span class="fu">c</span>(<span class="st">"X1986"</span>, <span class="st">"X1987"</span>, <span class="st">"X1988"</span>, <span class="st">"X1989"</span>, <span class="st">"X1990"</span>)]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> res <span class="ot">&lt;-</span> <span class="fu">CA</span>(exportaciones_costa_rica.CA, <span class="at">ncp =</span> <span class="dv">5</span>, <span class="at">row.sup =</span> <span class="cn">NULL</span>, <span class="at">col.sup =</span> <span class="cn">NULL</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(<span class="fu">plot.CA</span>(res, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">col.row =</span> <span class="st">"blue"</span>, <span class="at">col.col =</span> <span class="st">"red"</span>, <span class="at">title =</span> <span class="st">"Plano factorial principal AFC"</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"col"</span>, <span class="st">"col.sup"</span>, <span class="st">"row"</span>, <span class="st">"row.sup"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Laboratorio_5_Joshua_Cervantes_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="750"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(res, <span class="at">nb.dec =</span> <span class="dv">3</span>, <span class="at">nbelements =</span> <span class="dv">10</span>, <span class="at">nbind =</span> <span class="dv">10</span>, <span class="at">ncp =</span> <span class="dv">3</span>, <span class="at">file =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
CA(X = exportaciones_costa_rica.CA, ncp = 5, row.sup = NULL,  
     col.sup = NULL, graph = FALSE) 

The chi square of independence between the two variables is equal to 23.55103 (p-value =  0.9999593 ).

Eigenvalues
                       Dim.1   Dim.2   Dim.3   Dim.4
Variance               0.023   0.017   0.004   0.001
% of var.             51.388  37.692   8.832   2.087
Cumulative % of var.  51.388  89.080  97.913 100.000

Rows (the 10 first)
                       Iner*1000    Dim.1    ctr   cos2    Dim.2    ctr   cos2
Plantas ornamentales |     3.067 |  0.106  9.335  0.696 |  0.057  3.661  0.200
Flores               |     0.985 |  0.091  3.021  0.702 |  0.059  1.714  0.292
Follajes             |     3.699 | -0.147  9.016  0.557 |  0.092  4.799  0.218
Chayotes             |     1.176 |  0.098  1.402  0.273 |  0.068  0.910  0.130
Yuca                 |     0.798 |  0.018  0.090  0.026 |  0.090  2.919  0.614
Tubérculos           |     1.657 | -0.238  6.947  0.959 | -0.021  0.075  0.008
Piñas                |     1.396 |  0.016  0.321  0.053 | -0.038  2.354  0.283
Plátanos             |     1.271 |  0.239  3.889  0.700 |  0.139  1.788  0.236
Macadamia            |     0.181 | -0.105  0.481  0.607 |  0.050  0.147  0.136
Fresas               |     1.111 |  0.045  0.074  0.015 | -0.276  3.828  0.578
                        Dim.3    ctr   cos2  
Plantas ornamentales |  0.041  7.999  0.103 |
Flores               |  0.001  0.001  0.000 |
Follajes             |  0.093 21.012  0.223 |
Chayotes             | -0.139 16.399  0.548 |
Yuca                 | -0.020  0.618  0.030 |
Tubérculos           | -0.044  1.367  0.032 |
Piñas                | -0.058 23.181  0.653 |
Plátanos             | -0.069  1.878  0.058 |
Macadamia            |  0.048  0.597  0.129 |
Fresas               | -0.199  8.505  0.301 |

Columns
                       Iner*1000    Dim.1    ctr   cos2    Dim.2    ctr   cos2
X1986                |     9.017 |  0.233 25.242  0.640 |  0.162 16.714  0.311
X1987                |     7.768 |  0.204 26.852  0.791 |  0.088  6.786  0.147
X1988                |    11.894 |  0.062  3.441  0.066 | -0.227 63.592  0.897
X1989                |     3.990 | -0.066  4.668  0.268 | -0.028  1.186  0.050
X1990                |    11.833 | -0.177 39.797  0.769 |  0.082 11.723  0.166
                        Dim.3    ctr   cos2  
X1986                |  0.003  0.029  0.000 |
X1987                |  0.009  0.309  0.002 |
X1988                |  0.045 10.888  0.036 |
X1989                | -0.105 69.301  0.683 |
X1990                |  0.051 19.473  0.065 |</code></pre>
</div>
</div>
<p>En este caso se puede observar que existen dos exportaciones que se encuentran claramente alejadas de las demás así como del resto de años. Se puede observar que los platanos, petunias y chayotes, plantas ornamentales y flores aportaron más a los años 1986 y 1987, además de que estas se encuentran muy cercanas por lo que el comportamiento es similar. Ahora en cuanto a los años 1990 y 1989 estos se contraponen a los años 1986 y 1987 y la mayoría de las exportaciones están asociadas a tubércolos, macadamia y frijoles. En el año 1988 las fresas presentan una mayor presencia en comparación con años anteriores. Es interesante observar como los años donde los productos se encuentran más cercanos están asociados con gran aumento de en los montos de los mismos. En cuanto a calidad se podría decir que se pueden conservar los primeros ejes que que tengan una inercia explicada superior a 100/4 = 25 y que el siguiente eje sea inferior a este valor en este caso podría ser posible conservar los tres primeros ejes, aunque si se hicera por regla global de 75% se puedría conservar únicamente los primeros dos 2 ejes en general la calidad de representación se puede considerar como buena.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>